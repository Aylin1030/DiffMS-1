2025-10-28 15:03:52,842 - __main__ - INFO - ================================================================================
2025-10-28 15:03:52,843 - __main__ - INFO - 开始推理
2025-10-28 15:03:52,843 - __main__ - INFO - ================================================================================
2025-10-28 15:03:52,843 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:04:10,476 - __main__ - INFO - ================================================================================
2025-10-28 15:04:10,476 - __main__ - INFO - 开始推理
2025-10-28 15:04:10,476 - __main__ - INFO - ================================================================================
2025-10-28 15:04:10,477 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:04:13,635 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:04:13,635 - __main__ - INFO - 从checkpoint加载配置: /Users/aylin/Downloads/checkpoints/diffms_msg.ckpt
2025-10-28 15:05:50,438 - __main__ - INFO - ================================================================================
2025-10-28 15:05:50,438 - __main__ - INFO - 开始推理
2025-10-28 15:05:50,438 - __main__ - INFO - ================================================================================
2025-10-28 15:05:50,438 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:05:53,493 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:05:53,522 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:05:53,522 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:05:53,553 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:05:53,554 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:05:53,554 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:05:53,554 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:05:53,554 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:05:53,554 - __main__ - INFO - 使用GPU: False
2025-10-28 15:05:53,554 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:05:53,564 - root - INFO - Loading paired specs
2025-10-28 15:05:53,579 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:05:53,586 - root - INFO - Done creating spectra objects
2025-10-28 15:08:56,415 - __main__ - INFO - ================================================================================
2025-10-28 15:08:56,415 - __main__ - INFO - 开始推理
2025-10-28 15:08:56,415 - __main__ - INFO - ================================================================================
2025-10-28 15:08:56,415 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:08:59,644 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:08:59,675 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:08:59,675 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:08:59,709 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:08:59,710 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:08:59,710 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:08:59,710 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:08:59,710 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:08:59,710 - __main__ - INFO - 使用GPU: False
2025-10-28 15:08:59,710 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:08:59,718 - root - INFO - Loading paired specs
2025-10-28 15:08:59,735 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:08:59,742 - root - INFO - Done creating spectra objects
2025-10-28 15:09:26,658 - __main__ - INFO - ================================================================================
2025-10-28 15:09:26,659 - __main__ - INFO - 开始推理
2025-10-28 15:09:26,659 - __main__ - INFO - ================================================================================
2025-10-28 15:09:26,659 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:09:29,706 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:09:29,739 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:09:29,739 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:09:29,775 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:09:29,776 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:09:29,776 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:09:29,776 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:09:29,776 - __main__ - INFO - 使用GPU: False
2025-10-28 15:09:29,776 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:09:29,784 - root - INFO - Loading paired specs
2025-10-28 15:09:29,800 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:09:29,887 - root - INFO - Done creating spectra objects
2025-10-28 15:10:34,588 - __main__ - INFO - ================================================================================
2025-10-28 15:10:34,588 - __main__ - INFO - 开始推理
2025-10-28 15:10:34,588 - __main__ - INFO - ================================================================================
2025-10-28 15:10:34,588 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:10:37,756 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:10:37,787 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:10:37,788 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:10:37,822 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:11:41,456 - __main__ - INFO - ================================================================================
2025-10-28 15:11:41,456 - __main__ - INFO - 开始推理
2025-10-28 15:11:41,456 - __main__ - INFO - ================================================================================
2025-10-28 15:11:41,456 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:11:44,331 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:11:44,358 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:11:44,358 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:11:44,389 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:11:44,390 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:11:44,390 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:11:44,390 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:11:44,390 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:11:44,390 - __main__ - INFO - 使用GPU: False
2025-10-28 15:11:44,390 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:11:44,396 - root - INFO - Loading paired specs
2025-10-28 15:11:44,411 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:11:44,418 - root - INFO - Done creating spectra objects
2025-10-28 15:12:54,868 - __main__ - INFO - ================================================================================
2025-10-28 15:12:54,868 - __main__ - INFO - 开始推理
2025-10-28 15:12:54,868 - __main__ - INFO - ================================================================================
2025-10-28 15:12:54,868 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:12:57,651 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:12:57,677 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:12:57,678 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:12:57,709 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:12:57,710 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:12:57,710 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:12:57,710 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:12:57,710 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:12:57,710 - __main__ - INFO - 使用GPU: False
2025-10-28 15:12:57,710 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:12:57,718 - root - INFO - Loading paired specs
2025-10-28 15:12:57,734 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:12:57,740 - root - INFO - Done creating spectra objects
2025-10-28 15:13:06,220 - __main__ - INFO - ================================================================================
2025-10-28 15:13:06,220 - __main__ - INFO - 开始推理
2025-10-28 15:13:06,220 - __main__ - INFO - ================================================================================
2025-10-28 15:13:06,220 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:13:08,379 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:13:08,407 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:13:08,407 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:13:08,440 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:13:08,442 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:13:08,442 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:13:08,442 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:13:08,442 - __main__ - INFO - 使用GPU: False
2025-10-28 15:13:08,442 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:13:08,449 - root - INFO - Loading paired specs
2025-10-28 15:13:08,460 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:13:08,548 - root - INFO - Done creating spectra objects
2025-10-28 15:13:57,486 - __main__ - INFO - ================================================================================
2025-10-28 15:13:57,486 - __main__ - INFO - 开始推理
2025-10-28 15:13:57,486 - __main__ - INFO - ================================================================================
2025-10-28 15:13:57,486 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:14:00,697 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:14:00,729 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:14:00,730 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:14:00,765 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:14:00,767 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:14:00,767 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:14:00,767 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:14:00,767 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:14:00,767 - __main__ - INFO - 使用GPU: False
2025-10-28 15:14:00,767 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:14:00,775 - root - INFO - Loading paired specs
2025-10-28 15:14:00,791 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:14:00,799 - root - INFO - Done creating spectra objects
2025-10-28 15:16:01,921 - __main__ - INFO - ================================================================================
2025-10-28 15:16:01,921 - __main__ - INFO - 开始推理
2025-10-28 15:16:01,921 - __main__ - INFO - ================================================================================
2025-10-28 15:16:01,921 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:16:04,780 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:16:04,808 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:16:04,808 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:16:04,839 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:16:04,840 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:16:04,840 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:16:04,840 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:16:04,840 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:16:04,840 - __main__ - INFO - 使用GPU: False
2025-10-28 15:16:04,840 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:16:04,847 - root - INFO - Loading paired specs
2025-10-28 15:16:04,864 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:16:04,870 - root - INFO - Done creating spectra objects
2025-10-28 15:16:37,248 - __main__ - INFO - ================================================================================
2025-10-28 15:16:37,248 - __main__ - INFO - 开始推理
2025-10-28 15:16:37,248 - __main__ - INFO - ================================================================================
2025-10-28 15:16:37,248 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:16:39,334 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:16:39,357 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:16:39,357 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:16:39,386 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:16:39,387 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:16:39,387 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:16:39,387 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:16:39,388 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:16:39,388 - __main__ - INFO - 使用GPU: False
2025-10-28 15:16:39,388 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:16:39,394 - root - INFO - Loading paired specs
2025-10-28 15:16:39,405 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:16:39,411 - root - INFO - Done creating spectra objects
2025-10-28 15:16:57,075 - __main__ - INFO - ================================================================================
2025-10-28 15:16:57,076 - __main__ - INFO - 开始推理
2025-10-28 15:16:57,076 - __main__ - INFO - ================================================================================
2025-10-28 15:16:57,076 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:17:00,070 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:17:00,100 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:17:00,100 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:17:00,132 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:17:00,133 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:17:00,133 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:17:00,133 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:17:00,133 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:17:00,133 - __main__ - INFO - 使用GPU: False
2025-10-28 15:17:00,133 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:17:00,140 - root - INFO - Loading paired specs
2025-10-28 15:17:00,157 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:17:00,163 - root - INFO - Done creating spectra objects
2025-10-28 15:17:00,164 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:17:00,164 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:17:00,164 - __main__ - INFO -   Test数据集大小: 0
2025-10-28 15:17:31,372 - __main__ - INFO - ================================================================================
2025-10-28 15:17:31,372 - __main__ - INFO - 开始推理
2025-10-28 15:17:31,372 - __main__ - INFO - ================================================================================
2025-10-28 15:17:31,372 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:17:33,853 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:17:33,876 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:17:33,876 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:17:33,908 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:17:33,908 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:17:33,909 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:17:33,909 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:17:33,909 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:17:33,909 - __main__ - INFO - 使用GPU: False
2025-10-28 15:17:33,909 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:17:33,916 - root - INFO - Loading paired specs
2025-10-28 15:17:33,927 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:17:33,934 - root - INFO - Done creating spectra objects
2025-10-28 15:17:33,935 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:17:33,936 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:17:33,936 - __main__ - INFO -   Test数据集大小: 0
2025-10-28 15:17:51,189 - __main__ - INFO - ================================================================================
2025-10-28 15:17:51,189 - __main__ - INFO - 开始推理
2025-10-28 15:17:51,189 - __main__ - INFO - ================================================================================
2025-10-28 15:17:51,189 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:17:54,339 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:17:54,369 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:17:54,369 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:17:54,401 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:17:54,402 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:17:54,402 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:17:54,402 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:17:54,402 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:17:54,402 - __main__ - INFO - 使用GPU: False
2025-10-28 15:17:54,402 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:17:54,410 - root - INFO - Loading paired specs
2025-10-28 15:17:54,426 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:17:54,433 - root - INFO - Done creating spectra objects - Kept 0/1 samples
2025-10-28 15:17:54,435 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:17:54,435 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:17:54,435 - __main__ - INFO -   Test数据集大小: 0
2025-10-28 15:18:21,293 - __main__ - INFO - ================================================================================
2025-10-28 15:18:21,293 - __main__ - INFO - 开始推理
2025-10-28 15:18:21,293 - __main__ - INFO - ================================================================================
2025-10-28 15:18:21,293 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:18:23,982 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:18:24,011 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:18:24,011 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:18:24,042 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:18:24,042 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:18:24,043 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:18:24,043 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:18:24,043 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:18:24,043 - __main__ - INFO - 使用GPU: False
2025-10-28 15:18:24,043 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:18:24,050 - root - INFO - Loading paired specs
2025-10-28 15:18:24,060 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:18:24,067 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:18:44,629 - __main__ - INFO - ================================================================================
2025-10-28 15:18:44,629 - __main__ - INFO - 开始推理
2025-10-28 15:18:44,629 - __main__ - INFO - ================================================================================
2025-10-28 15:18:44,629 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:18:47,613 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:18:47,644 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:18:47,644 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:18:47,676 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:18:47,677 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:18:47,677 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:18:47,677 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:18:47,677 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:18:47,677 - __main__ - INFO - 使用GPU: False
2025-10-28 15:18:47,677 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:18:47,684 - root - INFO - Loading paired specs
2025-10-28 15:18:47,701 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:18:47,708 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:18:47,709 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:18:47,709 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:18:47,709 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:19:11,815 - __main__ - INFO - ================================================================================
2025-10-28 15:19:11,815 - __main__ - INFO - 开始推理
2025-10-28 15:19:11,815 - __main__ - INFO - ================================================================================
2025-10-28 15:19:11,815 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:19:13,986 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:19:14,009 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:19:14,009 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:19:14,040 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:19:14,041 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:19:14,041 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:19:14,041 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:19:14,041 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:19:14,041 - __main__ - INFO - 使用GPU: False
2025-10-28 15:19:14,041 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:19:14,048 - root - INFO - Loading paired specs
2025-10-28 15:19:14,058 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:19:14,065 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:19:14,066 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:19:14,066 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:19:14,066 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:20:03,855 - __main__ - INFO - ================================================================================
2025-10-28 15:20:03,855 - __main__ - INFO - 开始推理
2025-10-28 15:20:03,855 - __main__ - INFO - ================================================================================
2025-10-28 15:20:03,855 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:20:07,143 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:20:07,173 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:20:07,174 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:20:07,207 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:20:07,208 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:20:07,208 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:20:07,208 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:20:07,208 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:20:07,208 - __main__ - INFO - 使用GPU: False
2025-10-28 15:20:07,208 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:20:07,215 - root - INFO - Loading paired specs
2025-10-28 15:20:07,231 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:20:07,239 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:20:07,240 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:20:07,240 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:20:07,240 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:22:15,975 - __main__ - INFO - ================================================================================
2025-10-28 15:22:15,975 - __main__ - INFO - 开始推理
2025-10-28 15:22:15,975 - __main__ - INFO - ================================================================================
2025-10-28 15:22:15,975 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:22:18,979 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:22:19,007 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:22:19,007 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:22:19,039 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:22:19,040 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:22:19,040 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:22:19,040 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:22:19,040 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:22:19,040 - __main__ - INFO - 使用GPU: False
2025-10-28 15:22:19,040 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:22:19,048 - root - INFO - Loading paired specs
2025-10-28 15:22:19,064 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:22:19,071 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:22:19,072 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:22:19,072 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:22:19,072 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:31:17,058 - __main__ - INFO - ================================================================================
2025-10-28 15:31:17,058 - __main__ - INFO - 开始推理
2025-10-28 15:31:17,058 - __main__ - INFO - ================================================================================
2025-10-28 15:31:17,058 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:31:20,114 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:31:20,142 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:31:20,142 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:31:20,174 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:31:20,174 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:31:20,175 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:31:20,175 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:31:20,175 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:31:20,175 - __main__ - INFO - 使用GPU: False
2025-10-28 15:31:20,175 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:31:20,182 - root - INFO - Loading paired specs
2025-10-28 15:31:20,199 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:31:20,205 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:31:20,207 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:31:20,207 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:31:20,207 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:32:24,421 - __main__ - INFO - ================================================================================
2025-10-28 15:32:24,421 - __main__ - INFO - 开始推理
2025-10-28 15:32:24,421 - __main__ - INFO - ================================================================================
2025-10-28 15:32:24,421 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:32:27,439 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:32:27,468 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:32:27,468 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:32:27,502 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:32:27,503 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:32:27,503 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:32:27,503 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:32:27,503 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:32:27,503 - __main__ - INFO - 使用GPU: False
2025-10-28 15:32:27,503 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:32:27,511 - root - INFO - Loading paired specs
2025-10-28 15:32:27,527 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:32:27,535 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:32:27,536 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:32:27,536 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:32:27,536 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:32:35,141 - __main__ - INFO - 
步骤 3: 创建模型
2025-10-28 15:32:35,319 - root - INFO - Marginal distribution of the classes: tensor([0.7458, 0.1796, 0.0032, 0.0585, 0.0051, 0.0044, 0.0034, 0.0000]) for nodes, tensor([9.2989e-01, 4.3217e-02, 5.0077e-03, 4.0890e-05, 2.1845e-02]) for edges
2025-10-28 15:32:35,321 - __main__ - INFO - 加载权重: /Users/aylin/Downloads/checkpoints/diffms_msg.ckpt
2025-10-28 15:33:09,355 - __main__ - INFO - ================================================================================
2025-10-28 15:33:09,355 - __main__ - INFO - 开始推理
2025-10-28 15:33:09,355 - __main__ - INFO - ================================================================================
2025-10-28 15:33:09,355 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:33:12,550 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:33:12,580 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:33:12,580 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:33:12,612 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:33:12,613 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:33:12,613 - __main__ - INFO - 配置已修改为推理模式
2025-10-28 15:33:12,613 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:33:12,613 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:33:12,613 - __main__ - INFO - 使用GPU: False
2025-10-28 15:33:12,613 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:33:12,620 - root - INFO - Loading paired specs
2025-10-28 15:33:12,636 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:33:12,642 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:33:12,643 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:33:12,643 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:33:12,643 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:33:12,645 - __main__ - INFO - 推理模式：使用checkpoint中的固定维度
2025-10-28 15:33:12,648 - __main__ - INFO - 
步骤 3: 创建模型
2025-10-28 15:33:12,791 - root - INFO - Marginal distribution of the classes: tensor([0.7458, 0.1796, 0.0032, 0.0585, 0.0051, 0.0044, 0.0034, 0.0000]) for nodes, tensor([9.2989e-01, 4.3217e-02, 5.0077e-03, 4.0890e-05, 2.1845e-02]) for edges
2025-10-28 15:33:12,795 - __main__ - INFO - 加载权重: /Users/aylin/Downloads/checkpoints/diffms_msg.ckpt
2025-10-28 15:34:25,307 - __main__ - INFO - ================================================================================
2025-10-28 15:34:25,307 - __main__ - INFO - 开始推理
2025-10-28 15:34:25,307 - __main__ - INFO - ================================================================================
2025-10-28 15:34:25,308 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:34:28,299 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:34:28,328 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:34:28,328 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:34:28,360 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:34:28,361 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:34:28,361 - __main__ - INFO - 配置已修改为推理模式（使用MSG Large Model配置）
2025-10-28 15:34:28,361 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:34:28,361 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:34:28,361 - __main__ - INFO - 使用GPU: False
2025-10-28 15:34:28,361 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:34:28,370 - root - INFO - Loading paired specs
2025-10-28 15:34:28,387 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:34:28,395 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:34:28,396 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:34:28,397 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:34:28,397 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:34:28,400 - __main__ - INFO - 推理模式：使用checkpoint中的固定维度
2025-10-28 15:34:28,404 - __main__ - INFO - 
步骤 3: 创建模型
2025-10-28 15:34:28,565 - root - INFO - Marginal distribution of the classes: tensor([0.7458, 0.1796, 0.0032, 0.0585, 0.0051, 0.0044, 0.0034, 0.0000]) for nodes, tensor([9.2989e-01, 4.3217e-02, 5.0077e-03, 4.0890e-05, 2.1845e-02]) for edges
2025-10-28 15:34:28,568 - __main__ - INFO - 加载权重: /Users/aylin/Downloads/checkpoints/diffms_msg.ckpt
2025-10-28 15:34:28,712 - __main__ - INFO - ✓ 从checkpoint['state_dict']加载权重
2025-10-28 15:34:28,712 - __main__ - INFO - ✓ 模型创建和权重加载成功
2025-10-28 15:34:28,712 - __main__ - INFO - 
步骤 4: 创建Trainer并运行推理
2025-10-28 15:34:28,756 - pytorch_lightning.utilities.rank_zero - INFO - GPU available: True (mps), used: False
2025-10-28 15:34:28,764 - pytorch_lightning.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
2025-10-28 15:34:28,764 - pytorch_lightning.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
2025-10-28 15:34:28,765 - __main__ - INFO - 开始生成分子结构...
2025-10-28 15:34:28,766 - lightning_fabric.loggers.csv_logs - WARNING - Missing logger folder: test_cpu_run/inference_logs
2025-10-28 15:34:31,169 - root - INFO - Starting test...
2025-10-28 15:36:36,458 - __main__ - INFO - ================================================================================
2025-10-28 15:36:36,458 - __main__ - INFO - 开始推理
2025-10-28 15:36:36,458 - __main__ - INFO - ================================================================================
2025-10-28 15:36:36,458 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:36:39,536 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:36:39,565 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:36:39,566 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:36:39,602 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:36:39,603 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:36:39,603 - __main__ - INFO - 配置已修改为推理模式（使用MSG Large Model配置）
2025-10-28 15:36:39,603 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:36:39,603 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:36:39,603 - __main__ - INFO - 使用GPU: False
2025-10-28 15:36:39,603 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:36:39,611 - root - INFO - Loading paired specs
2025-10-28 15:36:39,626 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:36:39,633 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:36:39,635 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:36:39,635 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:36:39,635 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:36:39,637 - __main__ - INFO - 推理模式：使用checkpoint中的固定维度
2025-10-28 15:36:39,640 - __main__ - INFO - 
步骤 3: 创建模型
2025-10-28 15:36:39,801 - root - INFO - Marginal distribution of the classes: tensor([0.7458, 0.1796, 0.0032, 0.0585, 0.0051, 0.0044, 0.0034, 0.0000]) for nodes, tensor([9.2989e-01, 4.3217e-02, 5.0077e-03, 4.0890e-05, 2.1845e-02]) for edges
2025-10-28 15:36:39,805 - __main__ - INFO - 加载权重: /Users/aylin/Downloads/checkpoints/diffms_msg.ckpt
2025-10-28 15:36:39,944 - __main__ - INFO - ✓ 从checkpoint['state_dict']加载权重
2025-10-28 15:36:39,944 - __main__ - INFO - ✓ 模型创建和权重加载成功
2025-10-28 15:36:39,944 - __main__ - INFO - 
步骤 4: 创建Trainer并运行推理
2025-10-28 15:36:39,978 - pytorch_lightning.utilities.rank_zero - INFO - GPU available: True (mps), used: False
2025-10-28 15:36:39,984 - pytorch_lightning.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
2025-10-28 15:36:39,985 - pytorch_lightning.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
2025-10-28 15:36:39,985 - __main__ - INFO - 开始生成分子结构...
2025-10-28 15:36:42,377 - root - INFO - Starting test...
2025-10-28 15:37:40,616 - __main__ - INFO - ================================================================================
2025-10-28 15:37:40,617 - __main__ - INFO - 开始推理
2025-10-28 15:37:40,617 - __main__ - INFO - ================================================================================
2025-10-28 15:37:40,617 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:37:43,689 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:37:43,718 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:37:43,718 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:37:43,750 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:37:43,751 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:37:43,751 - __main__ - INFO - 配置已修改为推理模式（使用MSG Large Model配置）
2025-10-28 15:37:43,751 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:37:43,751 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:37:43,751 - __main__ - INFO - 使用GPU: False
2025-10-28 15:37:43,751 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:37:43,759 - root - INFO - Loading paired specs
2025-10-28 15:37:43,775 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:37:43,783 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:37:43,784 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:37:43,784 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:37:43,784 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:37:43,787 - __main__ - INFO - 推理模式：使用checkpoint中的固定维度
2025-10-28 15:37:43,790 - __main__ - INFO - 
步骤 3: 创建模型
2025-10-28 15:37:43,951 - root - INFO - Marginal distribution of the classes: tensor([0.7458, 0.1796, 0.0032, 0.0585, 0.0051, 0.0044, 0.0034, 0.0000]) for nodes, tensor([9.2989e-01, 4.3217e-02, 5.0077e-03, 4.0890e-05, 2.1845e-02]) for edges
2025-10-28 15:37:43,954 - __main__ - INFO - 加载权重: /Users/aylin/Downloads/checkpoints/diffms_msg.ckpt
2025-10-28 15:37:44,093 - __main__ - INFO - ✓ 从checkpoint['state_dict']加载权重
2025-10-28 15:37:44,093 - __main__ - INFO - ✓ 模型创建和权重加载成功
2025-10-28 15:37:44,093 - __main__ - INFO - 
步骤 4: 创建Trainer并运行推理
2025-10-28 15:37:44,129 - pytorch_lightning.utilities.rank_zero - INFO - GPU available: True (mps), used: False
2025-10-28 15:37:44,135 - pytorch_lightning.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
2025-10-28 15:37:44,135 - pytorch_lightning.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
2025-10-28 15:37:44,136 - __main__ - INFO - 开始生成分子结构...
2025-10-28 15:37:46,259 - root - INFO - Starting test...
2025-10-28 15:40:13,631 - __main__ - INFO - ================================================================================
2025-10-28 15:40:13,631 - __main__ - INFO - 开始推理
2025-10-28 15:40:13,631 - __main__ - INFO - ================================================================================
2025-10-28 15:40:13,631 - __main__ - INFO - 工作目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/src
2025-10-28 15:40:17,521 - __main__ - INFO - 
步骤 1: 加载配置
2025-10-28 15:40:17,564 - __main__ - INFO - 从YAML配置文件加载配置...
2025-10-28 15:40:17,564 - __main__ - INFO - 配置目录: /Users/aylin/yaolab_projects/diffms_yaolab/DiffMS/configs
2025-10-28 15:40:17,609 - __main__ - INFO - ✓ 配置加载成功
2025-10-28 15:40:17,610 - __main__ - INFO - 限制测试数据量: 1
2025-10-28 15:40:17,610 - __main__ - INFO - 配置已修改为推理模式（使用MSG Large Model配置）
2025-10-28 15:40:17,610 - __main__ - INFO - 数据集: custom_data
2025-10-28 15:40:17,610 - __main__ - INFO - 数据路径: /Users/aylin/yaolab_projects/madgen_yaolab/msdata/processed_data
2025-10-28 15:40:17,610 - __main__ - INFO - 使用GPU: False
2025-10-28 15:40:17,610 - __main__ - INFO - 
步骤 2: 创建数据模块
2025-10-28 15:40:17,621 - root - INFO - Loading paired specs
2025-10-28 15:40:17,641 - root - INFO - Converting paired samples into Spectra objects
2025-10-28 15:40:17,652 - root - INFO - Done creating spectra objects - Kept 1/1 samples
2025-10-28 15:40:17,655 - __main__ - INFO -   Train数据集大小: 0
2025-10-28 15:40:17,656 - __main__ - INFO -   Val数据集大小: 0
2025-10-28 15:40:17,656 - __main__ - INFO -   Test数据集大小: 1
2025-10-28 15:40:17,660 - __main__ - INFO - 推理模式：使用checkpoint中的固定维度
2025-10-28 15:40:17,665 - __main__ - INFO - 
步骤 3: 创建模型
2025-10-28 15:40:17,860 - root - INFO - Marginal distribution of the classes: tensor([0.7458, 0.1796, 0.0032, 0.0585, 0.0051, 0.0044, 0.0034, 0.0000]) for nodes, tensor([9.2989e-01, 4.3217e-02, 5.0077e-03, 4.0890e-05, 2.1845e-02]) for edges
2025-10-28 15:40:17,867 - __main__ - INFO - 加载权重: /Users/aylin/Downloads/checkpoints/diffms_msg.ckpt
2025-10-28 15:40:18,148 - __main__ - INFO - ✓ 从checkpoint['state_dict']加载权重
2025-10-28 15:40:18,148 - __main__ - INFO - ✓ 模型创建和权重加载成功
2025-10-28 15:40:18,148 - __main__ - INFO - 
步骤 4: 创建Trainer并运行推理
2025-10-28 15:40:18,199 - pytorch_lightning.utilities.rank_zero - INFO - GPU available: True (mps), used: False
2025-10-28 15:40:18,205 - pytorch_lightning.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
2025-10-28 15:40:18,205 - pytorch_lightning.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
2025-10-28 15:40:18,207 - __main__ - INFO - 开始生成分子结构...
2025-10-28 15:40:18,209 - lightning_fabric.loggers.csv_logs - WARNING - Missing logger folder: predictions/inference_logs
2025-10-28 15:40:21,828 - root - INFO - Starting test...
2025-10-28 15:45:40,878 - __main__ - INFO - 
================================================================================
2025-10-28 15:45:40,878 - __main__ - INFO - 推理完成！
2025-10-28 15:45:40,878 - __main__ - INFO - ================================================================================
2025-10-28 15:45:40,878 - __main__ - INFO - 
结果保存在: predictions
2025-10-28 15:45:40,879 - __main__ - INFO - 预测结果: preds
2025-10-28 15:45:40,879 - __main__ - INFO - 日志文件: predictions/inference_logs
